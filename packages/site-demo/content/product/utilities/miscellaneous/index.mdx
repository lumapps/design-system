---
frameworks: ['react', 'vue']
---

import { Message } from '@lumx/react';
import { FrameworkOnly } from '@lumx/demo/components/content/FrameworkOnly';

# Miscellaneous utilities

<FrameworkOnly framework="react">

The `@lumx/react/utils` module contains utilities like React hooks, functions and component that provide re-usable logic.

</FrameworkOnly>

<FrameworkOnly framework="vue">

The `@lumx/vue/utils` module contains utility components that provide re-usable logic.

</FrameworkOnly>

## ClickAwayProvider

A context provider that builds a tree (both DOM and component tree) of elements that are considered "within" the context even if children are rendered in a portal. User clicks outside this context will trigger the provided `callback`.

<FrameworkOnly framework="react">

```tsx
import { useRef } from 'react';
import { ClickAwayProvider } from '@lumx/react/utils';

const MyComponent = ({ close }) => {
    const cardRef = useRef(null);
    return (
        <ClickAwayProvider callback={close} childrenRefs={useRef([cardRef])}>
            <article ref={cardRef}>
                <p>Click outside this card to close it.</p>
                <Dropdown>...</Dropdown>
            </article>
        </ClickAwayProvider>
    );
};
```

</FrameworkOnly>

<FrameworkOnly framework="vue">

```html
<template>
    <ClickAwayProvider :callback="close" :childrenRefs="childrenRefs">
        <article ref="cardRef">
            <p>Click outside this card to close it.</p>
        </article>
    </ClickAwayProvider>
</template>

<script setup>
    import { ref, computed } from 'vue';
    import { ClickAwayProvider } from '@lumx/vue/utils';

    const emit = defineEmits(['close']);
    const close = () => emit('close');
    const cardRef = ref(null);
    const childrenRefs = ref([cardRef]);
</script>
```

</FrameworkOnly>

<Message kind="info">
    In this example, clicking outside the card will trigger the <code>close</code>
    callback. Clicks in children DOM nodes of the card or children of nested "click away" contexts are all considered as
    "in" the context and won't trigger the callback.
</Message>

This is used to provide correct "click away" behavior on nested `Dialog` or `Dropdown` even though they are not nested in the DOM tree.

## Portal

The `Portal` component renders its children into a new subtree outside of the current DOM hierarchy. By default, it renders to `document.body`. This is useful for components that need to appear above everything else, like `Dialog` or `Tooltip`.

You can use the `enabled` prop to conditionally render the portal.

## PortalProvider

The `PortalProvider` component allows you to specify a different container for all `Portal` components within its subtree.

The `PortalProvider` takes a `value` prop, which is a function that returns an object with a `container` (a DOM element or fragment). The `Portal` component, when used within a `PortalProvider`, will render its children into that container.

This is useful for scenarios where you need to render components in a specific part of your application's layout instead of `document.body`.

<FrameworkOnly framework="react">

```tsx
import { Button } from '@lumx/react';
import { Portal, PortalProvider } from '@lumx/react/utils';

function initPortal() {
    const container = document.createElement('div');
    document.body.appendChild(container);
    return { container, teardown: () => container.remove() };
}

const MyComponent = () => (
    <PortalProvider value={initPortal}>
        <p>The button below will be rendered inside a custom div appended to the document body.</p>
        <Portal>
            <Button>My button is in the portal</Button>
        </Portal>
    </PortalProvider>
);
```

</FrameworkOnly>

<FrameworkOnly framework="vue">

```html
<template>
    <PortalProvider :value="initPortal">
        <p>The button below will be rendered inside a custom div appended to the document body.</p>
        <Portal>
            <button>My button is in the portal</button>
        </Portal>
    </PortalProvider>
</template>

<script setup>
    import { Button } from '@lumx/vue';
    import { Portal, PortalProvider } from '@lumx/vue/utils';

    function initPortal() {
        const container = document.createElement('div');
        document.body.appendChild(container);
        return { container, teardown: () => container.remove() };
    }
</script>
```

</FrameworkOnly>

<Message kind="info">
    In this example, <code>initPortal</code> initializes a container div for all portals defined inside the children
    content
</Message>

<FrameworkOnly framework="react">

## Disabled state context

The `DisabledStateProvider` component allows you to set the disabled state of all components nested.

```tsx
import { Button, TextField, Checkbox } from '@lumx/react';
import { DisabledStateProvider } from '@lumx/react/utils';

const MyComponent = () => (
    <DisabledStateProvider state="disabled">
        <Button>Button</Button>
        <TextField />
        <Checkbox />
    </DisabledStateProvider>
);
```

<Message kind="info">
    In this example, the button, text field and checkbox in the context will all get disabled.
</Message>

To get your custom component to handle this disable state context, you can use the `useDisabledStateContext()` hook
(from the same `@lumx/react/utils` module).

</FrameworkOnly>
