import { Message } from '@lumx/react';

# Miscellaneous utilities

The `@lumx/react/utils` module contains utilities like React hooks, functions and component that provide re-usable logic.

## ClickAwayProvider

A React context provider that build a tree (both DOM and React) of elements that are considered "within" the context even if children are rendered as in a React portal. User clicks outside this context will trigger to provided `callback`.

```tsx
<ClickAwayProvider callback={close} childrenRefs={useRef([cardRef])}>
    <article ref={cardRef}>
        <p>Click outside this card to close it.</p>
        <Dropdown>...</Dropdown>
    </article>
</ClickAwayProvider>
```

<Message kind="info">
    In this example, clicking outside the card (referenced by <code>cardRef</code>) will trigger the <code>close</code> callback. Clicks in children DOM nodes of the card or children of nested "click away" contexts (here the dropdown) are all considered as "in" the the context and won't trigger the callback.
</Message>

This is used to provide correct "click away" behavior on nested `Dialog` or `Dropdown` even though they are not nested in the DOM tree.

## Portal

The `Portal` component renders its children into a new subtree outside of the current DOM hierarchy. By default, it renders to `document.body`. This is useful for components that need to appear above everything else, like `Dialog` or `Tooltip`.

You can use the `enabled` prop to conditionally render the portal.

## PortalProvider

The `PortalProvider` component allows you to specify a different container for all `Portal` components within its subtree.

The `PortalProvider` takes a `value` prop, which is a function that returns an object with a `container` (a DOM element or fragment). The `Portal` component, when used within a `PortalProvider`, will render its children into that container.

This is useful for scenarios where you need to render components in a specific part of your application's layout instead of `document.body`.

```tsx
import { Button } from '@lumx/react';
import { Portal, PortalProvider } from '@lumx/react/utils';
import React, { useEffect } from 'react';

function initPortal() {
    const container = document.createElement('div');
    document.body.appendChild(container);
    return { container, teardown: () => container.remove() };
}

const MyComponent = () => (
    <PortalProvider value={initPortal}>
        <p>The button below will be rendered inside a custom div appended to the document body.</p>
        <Portal>
            <Button>My button is in the portal</Button>
        </Portal>
    </PortalProvider>
);
```

<Message kind="info">
    In this example, `initPortal` initializes a container div for all portals defined inside the children content
</Message>

## Disabled state context

The `DisabledStateProvider` component allows you to set the disabled state of all components nested.

```tsx
import { Button, TextField, Checkbox } from '@lumx/react';
import { DisabledStateProvider } from '@lumx/react/utils';

const MyComponent = () => (
  <DisabledStateProvider state="disabled">
    <Button>Button</Button>
    <TextField />
    <Checkbox />
  </DisabledStateProvider>
)
```

<Message kind="info">
    In this example, the button, text field and checkbox in the context will all get disabled.
</Message>

To get your custom component to handle this disable state context, you can use the `useDisabledStateContext()` hook
(from the same `@lumx/react/utils` module).
